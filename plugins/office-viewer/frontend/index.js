(function(u,v,a){"use strict";var f={exports:{}},c={};var E;function R(){if(E)return c;E=1;var i=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function o(n,e,t){var d=null;if(t!==void 0&&(d=""+t),e.key!==void 0&&(d=""+e.key),"key"in e){t={};for(var l in e)l!=="key"&&(t[l]=e[l])}else t=e;return e=t.ref,{$$typeof:i,type:n,key:d,ref:e!==void 0?e:null,props:t}}return c.Fragment=s,c.jsx=o,c.jsxs=o,c}var w;function h(){return w||(w=1,f.exports=R()),f.exports}var r=h();const T={"Failed to load document link":"加载文档链接失败","Preparing document...":"正在准备文档...","Unable to load document":"无法加载文档","Invalid document link":"文档链接无效","Failed to generate an online preview link for the document.":"未能成功生成文档的在线查看链接。",Close:"关闭"},k=window.__FOXEL_EXTERNALS__.i18n,{t:g,useI18n:L}=k.create({zh:T}),F=({filePath:i,host:s})=>{const{foxelApi:o}=window.__FOXEL_EXTERNALS__,{t:n}=L(),[e,t]=u.useState(),[d,l]=u.useState(!0),[m,p]=u.useState();return u.useEffect(()=>{let _=!1;l(!0),p(void 0),t(void 0);const S=i.replace(/^\/+/,"");return o.vfs.getTempLinkToken(S).then(x=>{if(_)return;const j=window.__FOXEL_SYSTEM_STATUS__?.file_domain||window.location.origin,X=new URL(x.url,j).href,A=`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(X)}`;t(A)}).catch(x=>{_||p(x.message||"Failed to load document link")}).finally(()=>{_||l(!1)}),()=>{_=!0}},[i,o]),d?r.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(a.Spin,{tip:n("Preparing document...")})}):m?r.jsx(a.Result,{status:"error",title:n("Unable to load document"),subTitle:n(m),extra:r.jsx(a.Button,{type:"primary",onClick:s.close,children:n("Close")})}):r.jsx("div",{style:{width:"100%",height:"100%",background:"var(--ant-color-bg-container, #fff)"},children:e?r.jsx("iframe",{src:e,width:"100%",height:"100%",style:{border:"none"},title:"Office Document Viewer"}):r.jsx(a.Result,{status:"warning",title:n("Invalid document link"),subTitle:n("Failed to generate an online preview link for the document."),extra:r.jsx(a.Button,{type:"primary",onClick:s.close,children:n("Close")})})})};if(!window.__FOXEL_EXTERNALS__)throw console.error("[office-viewer] Foxel externals not found"),new Error("Foxel externals not found");window.FoxelRegister({mount:(i,s)=>{const o=v.createRoot(i);return o.render(u.createElement(F,s)),()=>o.unmount()}})})(window.__FOXEL_EXTERNALS__.React,window.__FOXEL_EXTERNALS__.ReactDOM,window.__FOXEL_EXTERNALS__.antd);
