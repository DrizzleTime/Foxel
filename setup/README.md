# Foxel 一键部署与管理脚本

这是一个用于自动化安装、配置和管理 Foxel 项目的 Shell 脚本。

脚本会自动检测您的环境，处理依赖，并提供一个简单易用的菜单来安装或管理您现有的 Foxel 实例。

## ✨ 主要功能

- **一键安装**：无需手动创建目录、下载文件或修改配置，脚本全程引导您完成。
- **智能管理**：自动检测现有安装，并切换到管理模式，方便您进行更新、卸载等操作。
- **依赖自动处理**：自动检测并提示安装 `curl`, `openssl` 等基础依赖。
- **国内镜像支持**：安装时会询问您是否在中国大陆，并自动为您切换到速度更快的国内镜像源。
- **交互式配置**：引导您自定义端口和生成安全的随机密钥。
- **全面的服务控制**：轻松启动、停止、重启服务以及查看实时日志。

## 🚀 如何使用

您只需要在您的服务器终端中运行以下一行命令即可，无需下载任何文件。

### 一键命令

```bash
bash <(curl -sL "https://raw.githubusercontent.com/DrizzleTime/Foxel/main/setup/foxel.sh?_=$(date +%s)")
```

## 脚本执行流程

1.  **环境检测**：检查 Docker, Docker Compose 以及其他必要命令是否已安装。
2.  **模式判断**：
    - 如果未安装 Foxel，将进入 **安装向导**。
    - 如果已安装 Foxel，将进入 **管理菜单**。
3.  **安装向导**：
    - 引导您设置安装路径。
    - 询问是否使用国内镜像源。
    - 引导您自定义端口和密钥。
    - 完成后启动 Foxel。
4.  **管理菜单**：
    - **更新**：拉取最新的 Docker 镜像并重新部署。
    - **卸载**：安全地移除容器和相关数据。
    - **重新安装**：彻底删除现有实例并返回安装向导。
    - **服务管理**：对容器进行启动、停止、重启和查看日志等操作。

## ⚠️ 注意事项

- 运行此脚本需要 `sudo` 权限，以便在需要时安装依赖包。
- 在执行 **更新**、**卸载** 或 **重新安装** 等危险操作前，请务必根据脚本的提示，手动备份您的重要数据。

## 🌍 示例
```yaml
=================================================
[信息] 欢迎使用 Foxel 一键安装与管理脚本 (版本: 1.6)
=================================================

[信息] 正在检查所需依赖...
[信息] 所有基础依赖均已满足。
[信息] Docker 环境检测通过。
[信息] 检测到 Docker Compose 命令: docker-compose

[信息] --- 开始 Foxel 全新安装 ---
请输入您想在哪里创建 Foxel 的数据目录 (例如: /opt/docker): /opt/docker
[信息] 将使用已存在的目录 '/opt/docker'。

[信息] 将在 '/opt/docker/Foxel' 目录中创建所需文件...
[信息] 正在下载 'compose.yaml'...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   562  100   562    0     0    344      0  0:00:01  0:00:01 --:--:--   703
[信息] 'compose.yaml' 下载成功。

您的服务器是否位于中国大陆（以便为您选择更快的镜像源）？ (y/n): y
[信息] 正在切换到国内镜像源...
[信息] 已成功切换到 ghcr.nju.edu.cn 镜像源。

请输入新的对外端口 (或直接按回车使用默认的 8088): 9823
[信息] 端口已成功修改为 9823。

是否需要生成新的随机密钥 (推荐)？(选择 'n' 将使用默认值) (y/n): y
[信息] 正在生成新的随机密钥...
[信息] 新的密钥已成功生成并替换。

所有配置已准备就绪！您想现在启动 Foxel 项目吗？ (y/n): y
[信息] 正在启动 Foxel 服务... 这可能需要一些时间来拉取镜像。
[+] Pulling 1/1
 ✔ foxel Pulled                                                                              1.6s 
[+] Running 1/1
 ✔ foxel Pulled                                                                              1.2s 
[+] Running 2/2
 ✔ Network foxel_foxel-network  Created                                                      0.1s 
 ✔ Container foxel              Started                                                      0.0s 
[信息] Foxel 部署成功！
[信息] -------------------------------------------------
[信息] 正在检测服务器IP地址，请稍候...

[信息] 部署完成！您可以通过以下地址访问 Foxel:
  - 局域网地址: http://10.0.0.222:9823
  - 公网地址 (IPv4): http://123.123.123.123:9823
  - 公网地址 (IPv6): http://[240e:3b2:8263:5b66:fd10:da55:c514:24ea]:9823
-------------------------------------------------

[信息] 脚本执行完毕。
root@debian:~# 
```
