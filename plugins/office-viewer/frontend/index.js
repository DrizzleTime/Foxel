(function(u,R,c){"use strict";var d={exports:{}},a={};var E;function m(){if(E)return a;E=1;var i=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function n(f,e,t){var s=null;if(t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),"key"in e){t={};for(var l in e)l!=="key"&&(t[l]=e[l])}else t=e;return e=t.ref,{$$typeof:i,type:f,key:s,ref:e!==void 0?e:null,props:t}}return a.Fragment=o,a.jsx=n,a.jsxs=n,a}var w;function v(){return w||(w=1,d.exports=m()),d.exports}var r=v();const h=({filePath:i,host:o})=>{const{foxelApi:n}=window.__FOXEL_EXTERNALS__,[f,e]=u.useState(),[t,s]=u.useState(!0),[l,p]=u.useState();return u.useEffect(()=>{let _=!1;s(!0),p(void 0),e(void 0);const T=i.replace(/^\/+/,"");return n.vfs.getTempLinkToken(T).then(x=>{if(_)return;const L=window.__FOXEL_SYSTEM_STATUS__?.file_domain||window.location.origin,S=new URL(x.url,L).href,j=`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(S)}`;e(j)}).catch(x=>{_||p(x.message||"加载文档链接失败")}).finally(()=>{_||s(!1)}),()=>{_=!0}},[i,n]),t?r.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(c.Spin,{tip:"正在准备文档..."})}):l?r.jsx(c.Result,{status:"error",title:"无法加载文档",subTitle:l,extra:r.jsx(c.Button,{type:"primary",onClick:o.close,children:"关闭"})}):r.jsx("div",{style:{width:"100%",height:"100%",background:"var(--ant-color-bg-container, #fff)"},children:f?r.jsx("iframe",{src:f,width:"100%",height:"100%",style:{border:"none"},title:"Office Document Viewer"}):r.jsx(c.Result,{status:"warning",title:"文档链接无效",subTitle:"未能成功生成文档的在线查看链接。",extra:r.jsx(c.Button,{type:"primary",onClick:o.close,children:"关闭"})})})};if(!window.__FOXEL_EXTERNALS__)throw console.error("[office-viewer] Foxel externals not found"),new Error("Foxel externals not found");window.FoxelRegister({mount:(i,o)=>{const n=R.createRoot(i);return n.render(u.createElement(h,o)),()=>n.unmount()}})})(window.__FOXEL_EXTERNALS__.React,window.__FOXEL_EXTERNALS__.ReactDOM,window.__FOXEL_EXTERNALS__.antd);
